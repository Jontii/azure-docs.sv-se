---
title: Sårbarhetsbedömning för SQL
titleSuffix: Azure SQL Database & SQL Managed Instance & Azure Synapse Analytics
description: Lär dig hur du konfigurerar SQL sårbarhet Assessment och tolkar utvärderings rapporterna på Azure SQL Database, Azure SQL-hanterad instans och Azure Synapse Analytics.
services: sql-database
ms.service: sql-db-mi
ms.subservice: security
ms.custom: sqldbrb=3
ms.devlang: ''
ms.topic: how-to
author: mibar
ms.author: mibar
ms.reviewer: vanto
ms.date: 09/21/2020
tags: azure-synapse
ms.openlocfilehash: 9dfbe81ce695fb3c44813966746e3137b14843f5
ms.sourcegitcommit: 829d951d5c90442a38012daaf77e86046018e5b9
ms.translationtype: MT
ms.contentlocale: sv-SE
ms.lasthandoff: 10/09/2020
ms.locfileid: "91839154"
---
# <a name="sql-vulnerability-assessment-helps-you-identify-database-vulnerabilities"></a>SQL sårbarhets bedömning hjälper dig att identifiera databas sårbarheter
[!INCLUDE[appliesto-sqldb-sqlmi](../includes/appliesto-sqldb-sqlmi.md)]

SQL sårbarhet Assessment är en tjänst som är enkel att konfigurera och som kan upptäcka, spåra och hjälpa dig att åtgärda potentiella databas sårbarheter. Du kan använda den för att proaktivt förbättra din databassäkerhet.

Sårbarhets bedömning ingår i [Azure Defender for SQL](azure-defender-for-sql.md) -erbjudandet, som är ett enhetligt paket för avancerade SQL-säkerhetsfunktioner. Sårbarhets bedömning kan nås och hanteras via den centrala Azure Defender för SQL-portalen.

> [!NOTE]
> Sårbarhets bedömning stöds för Azure SQL Database, Azure SQL-hanterad instans och Azure Synapse Analytics (tidigare SQL Data Warehouse). Databaser i Azure SQL Database, Azure SQL-hanterad instans och Azure Synapse Analytics kallas kollektivt i resten av den här artikeln som databaser, och servern refererar till den [Server](logical-servers.md) som är värd för databaser för Azure SQL Database och Azure Synapse.

## <a name="vulnerability-assessment"></a>Sårbarhetsbedömning

SQL sårbarhet Assessment är en tjänst som ger insyn i ditt säkerhets tillstånd. Sårbarhets bedömning innehåller åtgärder som kan vidtas för att lösa säkerhets problem och förbättra databas säkerheten. Det kan hjälpa dig att:

- Uppfylla kraven för efterlevnad som kräver databas skannings rapporter.
- Uppfylla data integritets standarder.
- Övervaka en dynamisk databas miljö där det är svårt att spåra ändringar.

Sårbarhets bedömning är en skannings tjänst som är inbyggd i Azure SQL Database. Tjänsten använder en kunskaps bas för regler som åtgärdar säkerhets sårbarheter. Den visar avvikelser från bästa praxis, till exempel felkonfigurationer, överdriven behörighet och oskyddade känsliga data.

Reglerna baseras på Microsofts bästa praxis och fokuserar på de säkerhets problem som utgör de största riskerna för din databas och dess värdefulla data. De behandlar problem på databas nivå och säkerhets problem på server nivå, t. ex. inställningar för Server brand väggen och behörigheter på server nivå. Dessa regler motsvarar också många av kraven från olika myndigheter för att uppfylla deras efterlevnad.

Resultaten av genomsökningen innehåller åtgärds bara steg för att lösa varje problem och tillhandahålla anpassade reparations skript där det är tillämpligt. Du kan anpassa en utvärderings rapport för din miljö genom att ange en acceptabel bas linje för:

- Behörighets konfiguration
- Funktions konfiguration
- Databas inställningar

## <a name="implement-vulnerability-assessment"></a>Implementera sårbarhets bedömning

Följande steg implementerar sårbarhets bedömningen:

### <a name="1-run-a-scan"></a>1. kör en sökning

1. Gå till din Azure SQL Database, SQL-hanterade instans databas eller Azure Synapse-resurs i [Azure Portal](https://portal.azure.com).

1. Under **säkerhets** rubriken väljer du **Security Center**.

1. Klicka sedan på **Välj lagring** i fönstret **sårbarhets bedömning** för att öppna fönstret inställningar för sårbarhets bedömning för antingen hela servern eller den hanterade instansen.  

    > [!NOTE]
    > Mer information om hur du lagrar sårbarhets bedömnings genomsökningar bakom brand väggar och virtuella nätverk finns i [Sök Resultat för sökning efter sårbarhets bedömning i ett lagrings konto som är tillgängligt bakom brand väggar och virtuella nätverk](sql-database-vulnerability-assessment-storage.md).

1. Konfigurera ett lagrings konto där genomsöknings resultaten för alla databaser på servern eller den hanterade instansen kommer att lagras. Information om lagrings konton finns i [om Azure Storage-konton](../../storage/common/storage-account-create.md). När lagring har kon figurer ATS väljer du **Genomsök** för att söka igenom databasen efter sårbarheter.

![Skanna en databas](./media/sql-vulnerability-assessment/pp_va_initialize.png)

  > [!NOTE]
  > Genomsökningen är lätt och säker. Det tar några sekunder att köra och är helt skrivskyddat. Det gör inga ändringar i databasen.

### <a name="2-view-the-report"></a>2. Visa rapporten

När genomsökningen är färdig visas din skannings rapport automatiskt i Azure Portal. Rapporten visar en översikt över ditt säkerhets tillstånd. Den visar hur många problem som har hittats och deras respektive allvarlighets grader. Resultaten innehåller varningar om avvikelser från bästa praxis och en ögonblicks bild av dina säkerhetsrelaterade inställningar, t. ex. databasens huvud namn och roller och deras associerade behörigheter. I skannings rapporten finns även en karta över känsliga data som har identifierats i databasen. Den innehåller rekommendationer för att klassificera data med hjälp av [identifiering och klassificering av data](data-discovery-and-classification-overview.md).

![Visa rapporten](./media/sql-vulnerability-assessment/pp_main_getstarted.png)

### <a name="3-analyze-the-results-and-resolve-issues"></a>3. analysera resultaten och lös problem

Granska resultaten och fastställ resultaten i rapporten som är sanna säkerhets problem i din miljö. Öka detalj nivån till varje misslyckat resultat för att förstå effekten av att hitta och varför varje säkerhets kontroll misslyckades. Använd den åtgärds bara reparations information som anges i rapporten för att lösa problemet.

![Analysera rapporten](./media/sql-vulnerability-assessment/pp_fail_rule_show_remediation.png)

### <a name="4-set-your-baseline"></a>4. Ange din bas linje

När du granskar resultatet av utvärderingen kan du markera speciella resultat som en acceptabel *bas linje* i din miljö. Bas linjen är i grunden en anpassning av hur resultaten rapporteras. Resultat som matchar bas linjen betraktas som att skickas vid efterföljande genomsökningar. När du har fastställt ditt grundläggande säkerhets tillstånd kan du endast rapportera om avvikelser från bas linjen i utlösnings utvärderingen. På så sätt kan du fokusera på de relevanta problemen.

![Ange din bas linje](./media/sql-vulnerability-assessment/pp_fail_rule_show_baseline.png)

### <a name="5-run-a-new-scan-to-see-your-customized-tracking-report"></a>5. kör en ny sökning för att se din anpassade spårnings rapport

När du har slutfört konfigurationen av **regelns bas linjer**kör du en ny sökning för att visa den anpassade rapporten. Vid en sårbarhets bedömning rapporteras nu bara de säkerhets problem som avviker från ditt godkända bas linje tillstånd.

![Visa din anpassade rapport](./media/sql-vulnerability-assessment/pp_pass_main_with_baselines.png)

Nu kan du använda en sårbarhets bedömning för att övervaka att databasen har en hög säkerhets nivå hela tiden och att organisationens principer är uppfyllda. Om det krävs Kompatibilitetsrapport, kan det vara bra att använda utvärderings rapporter för att förenkla processen för efterlevnad.

### <a name="6-set-up-periodic-recurring-scans"></a>6. konfigurera periodiska återkommande genomsökningar

Gå till inställningarna för sårbarhets bedömning för att aktivera **regelbundna återkommande genomsökningar**. Den här inställningen konfigurerar sårbarhets bedömning för att automatiskt köra en genomsökning i databasen en gång per vecka. En sammanfattning av skannings resultatet skickas till e-postadresserna du anger.

![inställning av återkommande genomsökningar](./media/sql-vulnerability-assessment/pp_recurring_scans.png)

### <a name="7-export-an-assessment-report"></a>7. exportera en utvärderings rapport

Välj **Exportera skannings resultat** för att skapa en nedladdnings bar Excel-rapport över ditt genomsöknings resultat. Den här rapporten innehåller en sammanfattnings flik som visar en sammanfattning av utvärderingen. Rapporten innehåller alla misslyckade kontroller. Den innehåller också en **resultat** -flik som innehåller den fullständiga uppsättningen resultat från sökningen. Resultatet inkluderar alla kontroller som kördes och resultat informationen för varje.

### <a name="8-view-scan-history"></a>8. Visa genomsöknings historik

Välj **genomsöknings historik** i fönstret sårbarhets bedömning om du vill visa en historik över alla genomsökningar som tidigare har körts på den här databasen. Välj en viss sökning i listan om du vill visa detaljerade resultat för den genomsökningen.

Nu kan du använda en sårbarhets bedömning för att övervaka att databasen har en hög säkerhets nivå hela tiden och att organisationens principer är uppfyllda. Om det krävs Kompatibilitetsrapport, kan det vara bra att använda utvärderings rapporter för att förenkla processen för efterlevnad.

## <a name="manage-vulnerability-assessments-by-using-azure-powershell"></a>Hantera sårbarhets bedömningar med hjälp av Azure PowerShell

[!INCLUDE [updated-for-az](../../../includes/updated-for-az.md)]
> [!IMPORTANT]
> PowerShell Azure Resource Manager-modulen stöds fortfarande, men all framtida utveckling gäller AZ. SQL-modulen. De här cmdletarna finns i [AzureRM. SQL](https://docs.microsoft.com/powershell/module/AzureRM.Sql/). Argumenten för kommandona i AZ-modulen och i AzureRm-modulerna är i stort sett identiska.

Du kan använda Azure PowerShell-cmdletar för att hantera dina sårbarhets bedömningar program mässigt. De cmdlet: ar som stöds är:

| Cmdlet-namn som en länk | Beskrivning |
| :-------------------- | :---------- |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Rensar regelns bas linje för sårbarhets bedömning.<br/>Börja med att ange bas linjen innan du använder denna cmdlet för att ta bort den. |
| [Clear-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-azSqlDatabaseVulnerabilityAssessmentSetting) | Rensar inställningarna för sårbarhets bedömning för en databas. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Rensar regelns bas linje för sårbarhets bedömning för en hanterad databas.<br/>Börja med att ange bas linjen innan du använder denna cmdlet för att ta bort den. |
| [Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Rensar inställningarna för sårbarhets bedömning för en hanterad databas. |
| [Clear-AzSqlInstanceVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Clear-AzSqlInstanceVulnerabilityAssessmentSetting) | Rensar inställningarna för sårbarhets bedömning för en hanterad instans. |
| [Konvertera-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-azSqlDatabaseVulnerabilityAssessmentScan) | Konverterar genomsöknings resultat för sårbarhets bedömning av en databas till en Excel-fil. |
| [Konvertera-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Convert-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Konverterar genomsöknings resultat för sårbarhets bedömning för en hanterad databas till en Excel-fil. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Hämtar regelns bas linje för sårbarhets bedömning av en databas för en specifik regel. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Hämtar regelns bas linje för sårbarhets bedömning för en hanterad databas för en specifik regel. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentScanRecord) | Hämtar alla genomsöknings poster för sårbarhets bedömning som är associerade med en specifik databas. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord](https://docs.microsoft.com/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentScanRecord) | Hämtar alla genomsöknings poster för sårbarhets bedömning som är kopplade till en specifik hanterad databas. |
| [Get-AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-azSqlDatabaseVulnerabilityAssessmentSetting) | Returnerar inställningarna för sårbarhets bedömning för en databas. |
| [Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Get-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Returnerar inställningarna för sårbarhets bedömning för en hanterad databas. |
| [Set-AzSqlDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-azSqlDatabaseVulnerabilityAssessmentRuleBaseline) | Anger regelns bas linje för sårbarhets bedömning. |
| [Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline](https://docs.microsoft.com/powershell/module/az.sql/Set-AzSqlInstanceDatabaseVulnerabilityAssessmentRuleBaseline) | Anger regel bas linje för sårbarhets bedömning för en hanterad databas. |
| [Start-AzSqlDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-azSqlDatabaseVulnerabilityAssessmentScan) | Utlöser starten av en sökning efter sårbarhets bedömning på en databas. |
| [Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan](https://docs.microsoft.com/powershell/module/az.sql/Start-AzSqlInstanceDatabaseVulnerabilityAssessmentScan) | Utlöser starten av en sökning efter sårbarhets bedömning på en hanterad databas. |
| [Uppdatera – AzSqlDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-azSqlDatabaseVulnerabilityAssessmentSetting) | Uppdaterar inställningarna för sårbarhets bedömning för en databas. |
| [Uppdatera – AzSqlInstanceDatabaseVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-AzSqlInstanceDatabaseVulnerabilityAssessmentSetting) | Uppdaterar inställningarna för sårbarhets bedömning för en hanterad databas. |
| [Uppdatera – AzSqlInstanceVulnerabilityAssessmentSetting](https://docs.microsoft.com/powershell/module/az.sql/Update-AzSqlInstanceVulnerabilityAssessmentSetting) | Uppdaterar inställningarna för sårbarhets bedömning för en hanterad instans. |
| &nbsp; | &nbsp; |

Ett skript exempel finns i [PowerShell-support för Azure SQL sårbarhet Assessment](https://blogs.msdn.microsoft.com/sqlsecurity/20../../azure-sql-vulnerability-assessment-now-with-powershell-support/).

## <a name="manage-vulnerability-assessment-baseline-rules-by-using-resource-manager-templates"></a>Hantera bas linje regler för sårbarhets bedömning med hjälp av Resource Manager-mallar

Om du vill konfigurera bas linjer för sårbarhets bedömning med Azure Resource Manager mallar använder du `Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines` typen.

Kontrol lera att du har aktiverat `vulnerabilityAssessments` innan du lägger till bas linjer.

Här är ett exempel på hur du definierar VA2065 för bas linje regel för `master` databas och VA1143 till `user` databas som resurser i en Resource Manager-mall:

```json
   "resources": [
      {
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name') , '/default/VA2065/master')]",
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "FirewallRuleName3",
                     "StartIpAddress",
                     "EndIpAddress"
                  ]
               },
               {
                  "result": [
                     "FirewallRuleName4",
                     "62.92.15.68",
                     "62.92.15.68"
                  ]
               }
            ]
         },
         "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
         "apiVersion": "2018-06-01-preview",
         "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA2130/Default')]",
         "dependsOn": [
            "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
         ],
         "properties": {
            "baselineResults": [
               {
                  "result": [
                     "dbo"
                  ]
               }
            ]
         }
      }
   ]
```

För `master` databas och `user` databas definieras resurs namnen på olika sätt:

- Master-databas-"namn": "[concat (parameters (server_name),"/", parametrar (' database_name '), '/default/VA2065/<b>Master</b>')]",
- Användar databas – "namn": "[concat (parameters (server_name),"/", parametrar (' database_name '), '/default/VA2065/<b>default</b>')]",

Om du vill hantera booleska typer som TRUE/FALSE anger du bas linje resultatet med binär Indatatyp som "1"/"0".

```json
   {
      "type": "Microsoft.Sql/servers/databases/vulnerabilityAssessments/rules/baselines",
      "apiVersion": "2018-06-01-preview",
      "name": "[concat(parameters('server_name'),'/', parameters('database_name'), '/default/VA1143/Default')]",

      "dependsOn": [
         "[resourceId('Microsoft.Sql/servers/vulnerabilityAssessments', parameters('server_name'), 'Default')]"
      ],

      "properties": {
         "baselineResults": [
            {
               "result": [
                  "1"
               ]
            }
         ]
      }

   }
```

## <a name="next-steps"></a>Nästa steg  

- Läs mer om [Azure Defender för SQL](azure-defender-for-sql.md).
- Läs mer om [data identifiering och klassificering](data-discovery-and-classification-overview.md).
- Läs om hur du [lagrar genomsöknings resultat för sårbarhets bedömning i ett lagrings konto som är tillgängligt bakom brand väggar och virtuella nätverk](sql-database-vulnerability-assessment-storage.md).
